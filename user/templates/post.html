{% load static %}
{% load user_tags %}

<div class="user_{{ type }}">
    <div class="note_info">
        <div class="note_poster_full_name">
            {% if post.user %}
                <a href="{% url 'user_page' user_id=post.user.user_id %}">
                    {{ post.user.first_name }} {{ post.user.last_name }}
                </a>
            {% elif post.community %}
                <a href="{% url 'community_page' community_id=post.community.community_id %}">
                    {{ post.community.name }}
                </a>
            {% endif %}
        </div>
        <div>
            {% post_edit_menu_tag type=type community_id=community.community_id user_id=user.user_id note_id=note.note_id comment_id=comment.comment_id reply_id=reply.reply_id %}
        </div>
    </div>
    <br><div>{{ post.text }}</div><br>
    <div class="note_time">{{ post.publish_time|date:'d-m-Y H:i:s' }}</div>
    {% if post.update_time != post.publish_time %}
        <div class="note_time">Last edited: {{ post.update_time|date:'d-m-Y H:i:s' }}</div>
    {% endif %}
    <br><div class="note_statistics">
            <div>
                {% post_like_tag type=type post=post user=user note=note comment=comment reply=reply %}
            </div>
        {% if type == 'note' %}
            <div>
                <img src="{% static 'icons/comment_icon.png' %}" alt="" width="15px" height="15px" class="comment_icon">
                {{ post.comments.all|length }}
            </div>
            <div>
                Reposts: {{ post.reposts_amount }}
            </div>
        {% elif type == 'comment' %}
            <div>
                <img src="{% static 'icons/reply_icon.png' %}" alt="" width="15px" height="15px" class="reply_icon">
                {{ post.replies.all|length }}
            </div>
        {% endif %}
    </div>
    {% if type != 'reply' %}
        {% if type == 'note' %}
            <br><div class="note_comments">
                {% if post.comments.all %}
                    {% for comment in post.comments.all %}
                        {% post_tag type='comment' post=comment user=user community=community comment=comment note=note form=form %}
                    {% endfor %}
                {% else %}
                    No comments yet
                {% endif %}
                {% form_tag form=form type='comment' note=note comment=comment %}
            </div>
        {% elif type == 'comment' %}
           <br><div class="comment_replies">
                {% if post.replies.all %}
                    {% for reply in post.replies.all %}
                        {% post_tag type='reply' post=reply user=user community=community note=note comment=comment reply=reply %}
                    {% endfor %}
                {% else %}
                    No replies yet
                {% endif %}
                {% form_tag form=form type='reply' note=note comment=comment %}
            </div>
        {% endif %}
    {% endif %}
</div>